<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronograma de Estudio 2026</title>
    <!-- Tailwind CSS para el dise√±o -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome para los iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        select { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; padding-right: 2.5rem; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen pb-12">

    <!-- Encabezado con degradado -->
    <header class="bg-gradient-to-r from-indigo-600 to-blue-600 text-white py-16 px-4 shadow-lg">
        <div class="max-w-6xl mx-auto text-center">
            <h1 class="text-4xl md:text-5xl font-extrabold mb-4 tracking-tight">Cronograma de Estudio</h1>
            <p class="text-xl md:text-2xl text-blue-100 max-w-2xl mx-auto font-semibold tracking-wide">Preicfes Saber 11 de la UNAL</p>
        </div>
    </header>

    <!-- Secci√≥n de Filtros -->
    <div class="max-w-6xl mx-auto px-4 -mt-8 relative z-10">
        <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col md:flex-row gap-6 items-center justify-between border border-slate-100">
            <div class="flex-1 w-full relative">
                <label class="block text-sm font-semibold text-slate-600 mb-2" for="monthFilter">
                    <i class="far fa-calendar-alt mr-1"></i> Filtrar por Mes
                </label>
                <select id="monthFilter" class="w-full border border-slate-300 rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 appearance-none bg-slate-50 transition-colors cursor-pointer">
                    <option value="all">üóìÔ∏è Todos los meses</option>
                    <!-- Las opciones se inyectan por JS -->
                </select>
            </div>
            
            <div class="flex-1 w-full relative">
                <label class="block text-sm font-semibold text-slate-600 mb-2" for="areaFilter">
                    <i class="fas fa-layer-group mr-1"></i> Filtrar por √Årea
                </label>
                <select id="areaFilter" class="w-full border border-slate-300 rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 appearance-none bg-slate-50 transition-colors cursor-pointer">
                    <option value="all">üìö Todas las √°reas</option>
                    <!-- Las opciones se inyectan por JS -->
                </select>
            </div>
            
            <div class="w-full md:w-auto mt-2 md:mt-0 pt-6 text-center md:text-right">
                <span class="inline-block bg-indigo-50 text-indigo-700 font-medium px-4 py-2 rounded-full text-sm shadow-sm" id="resultsCount">
                    Cargando clases...
                </span>
            </div>
        </div>
    </div>

    <!-- Contenedor Principal del Cronograma -->
    <main class="max-w-6xl mx-auto px-4 mt-12">
        <div id="schedule-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Las tarjetas se generan din√°micamente aqu√≠ -->
        </div>

        <!-- Estado de "Sin Resultados" -->
        <div id="no-results" class="hidden flex flex-col items-center justify-center py-20">
            <div class="bg-slate-100 p-6 rounded-full mb-4">
                <i class="fas fa-search text-4xl text-slate-400"></i>
            </div>
            <h3 class="text-2xl font-semibold text-slate-700">No se encontraron sesiones</h3>
            <p class="text-slate-500 mt-2 text-center max-w-md">Intenta ajustar los filtros de b√∫squeda o seleccionar un mes y √°rea diferentes.</p>
            <button onclick="resetFilters()" class="mt-6 text-indigo-600 font-medium hover:text-indigo-800 transition-colors">
                Limpiar filtros
            </button>
        </div>
    </main>

    <script>
        // =========================================================================

        // =========================================================================
        const GOOGLE_SHEETS_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRqGcVYnfCKAlgYksSBlCLoOxox6Msrok1eSmsEsyDe5S8zscqL0z9UUMxhhPq2Wg/pub?output=csv"; 

        // =========================================================================
        // Datos de respaldo (Se usar√°n si no has puesto el enlace de Google Sheets arriba)
        // =========================================================================
        const fallbackData = `Fecha;D√≠a;Horario;√Årea;Tema / Evento
23-feb;Lunes;5:00 p.m. a 7:00 p.m.;Biolog√≠a;M√©todo Cient√≠fico y C√©lula
24-feb;Martes;5:00 p.m. a 7:00 p.m.;Biolog√≠a;Procesos Celulares (Respiraci√≥n, Fotos√≠ntesis)
25-feb;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;CANCELADO;Clase Cancelada
26-feb;Jueves;5:00 p.m. a 7:00 p.m.;Biolog√≠a;Gen√©tica I (Leyes de Mendel)
28-feb;S√°bado;8:00 a.m. a 10:00 a.m.;Biolog√≠a;Gen√©tica II (ADN y ARN)
2-mar;Lunes;5:00 p.m. a 7:00 p.m.;Sociales;Historia y Geograf√≠a base
3-mar;Martes;5:00 p.m. a 7:00 p.m.;Sociales;Geograf√≠a Econ√≥mica
4-mar;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Sociales;Historia Universal y Latinoamericana
5-mar;Jueves;5:00 p.m. a 7:00 p.m.;Sociales;Constituci√≥n Pol√≠tica de 1991
7-mar;S√°bado;8:00 a.m. a 10:00 a.m.;SIMULACRO;üìå PRIMER SIMULACRO (DIAGN√ìSTICO)
9-mar;Lunes;5:00 p.m. a 7:00 p.m.;Biolog√≠a;Organismos y Clasificaci√≥n
10-mar;Martes;5:00 p.m. a 7:00 p.m.;Biolog√≠a;Sistemas del Cuerpo Humano I
11-mar;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Biolog√≠a;Sistemas del Cuerpo Humano II
12-mar;Jueves;5:00 p.m. a 7:00 p.m.;Biolog√≠a;Ecosistemas y Poblaciones
14-mar;S√°bado;8:00 a.m. a 10:00 a.m.;Biolog√≠a;Evoluci√≥n y origen de la vida
16-mar;Lunes;5:00 p.m. a 7:00 p.m.;Sociales;Derechos y Deberes Fundamentales
17-mar;Martes;5:00 p.m. a 7:00 p.m.;Sociales;Mecanismos de Participaci√≥n
18-mar;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Sociales;Competencias Ciudadanas I
19-mar;Jueves;5:00 p.m. a 7:00 p.m.;Sociales;An√°lisis de Perspectivas
21-mar;S√°bado;8:00 a.m. a 10:00 a.m.;Lectura Cr√≠tica;Comprensi√≥n a nivel local
23-mar;Lunes;5:00 p.m. a 7:00 p.m.;FESTIVO;D√≠a de San Jos√© - No hay clase
24-mar;Martes;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Comprensi√≥n a nivel global
25-mar;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Intenci√≥n comunicativa
26-mar;Jueves;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Tipolog√≠as Textuales
28-mar;S√°bado;8:00 a.m. a 10:00 a.m.;Lectura Cr√≠tica;Textos Discontinuos (Infograf√≠as)
6-abr;Lunes;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Argumentaci√≥n y premisas
7-abr;Martes;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Validez de argumentos
8-abr;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Estrategias discursivas
9-abr;Jueves;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Lectura filos√≥fica
11-abr;S√°bado;8:00 a.m. a 10:00 a.m.;Lectura Cr√≠tica;Intertextualidad
13-abr;Lunes;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Evaluaci√≥n de contenidos
14-abr;Martes;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Ensayo y Columna de opini√≥n
15-abr;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Taller Intensivo de lectura
16-abr;Jueves;5:00 p.m. a 7:00 p.m.;Lectura Cr√≠tica;Cierre de M√≥dulo
18-abr;S√°bado;8:00 a.m. a 10:00 a.m.;Lectura Cr√≠tica;Taller final de repaso
20-abr;Lunes;5:00 p.m. a 7:00 p.m.;Matem√°ticas;√Ålgebra b√°sica y expresiones
21-abr;Martes;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Funciones y relaciones
22-abr;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Funci√≥n Lineal y Cuadr√°tica
23-abr;Jueves;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Exponenciales y Logaritmos
25-abr;S√°bado;8:00 a.m. a 10:00 a.m.;Matem√°ticas;Geometr√≠a Plana (√Åreas y Per√≠metros)
27-abr;Lunes;5:00 p.m. a 7:00 p.m.;Matem√°ticas;S√≥lidos y Vol√∫menes
28-abr;Martes;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Teorema de Pit√°goras
29-abr;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Razones Trigonom√©tricas
30-abr;Jueves;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Estad√≠stica Descriptiva
1-may;Viernes;5:00 p.m. a 7:00 p.m.;FESTIVO;D√≠a del Trabajo
2-may;S√°bado;8:00 a.m. a 10:00 a.m.;Matem√°ticas;Probabilidad y azar
4-may;Lunes;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Conteo y Combinatoria
5-may;Martes;5:00 p.m. a 7:00 p.m.;üó£Ô∏è CHARLA 1;El Mapa del √âxito (Estructura ICFES)
6-may;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Interpretaci√≥n de Gr√°ficas
7-may;Jueves;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Cierre de M√≥dulo
9-may;S√°bado;8:00 a.m. a 10:00 a.m.;SIMULACRO;üìå SEGUNDO SIMULACRO (INTERMEDIO)
11-may;Lunes;5:00 p.m. a 7:00 p.m.;Matem√°ticas;Taller Pr√°ctico Final
12-may;Martes;5:00 p.m. a 7:00 p.m.;üó£Ô∏è CHARLA 2;Mente de Acero (Ansiedad y Estr√©s)
13-may;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Sociales;Globalizaci√≥n y Econom√≠a
14-may;Jueves;5:00 p.m. a 7:00 p.m.;Sociales;Problem√°ticas Sociales
16-may;S√°bado;8:00 a.m. a 10:00 a.m.;Sociales;Violencia y Sociedad en Colombia
18-may;Lunes;5:00 p.m. a 7:00 p.m.;FESTIVO;D√≠a de la Ascensi√≥n
19-may;Martes;5:00 p.m. a 7:00 p.m.;üó£Ô∏è CHARLA 3;Foco de Atleta (Concentraci√≥n)
20-may;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Sociales;Competencias Ciudadanas II
21-may;Jueves;5:00 p.m. a 7:00 p.m.;Sociales;Cierre de M√≥dulo
23-may;S√°bado;8:00 a.m. a 10:00 a.m.;Biolog√≠a;CTS (Ciencia, Tec, Sociedad)
25-may;Lunes;5:00 p.m. a 7:00 p.m.;FESTIVO;Corpus Christi
26-may;Martes;5:00 p.m. a 7:00 p.m.;üó£Ô∏è CHARLA 4;El Arte de la Duda (Estrategia)
27-may;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Biolog√≠a;CTS (Ciencia, Tec, Sociedad)
28-may;Jueves;5:00 p.m. a 7:00 p.m.;Biolog√≠a;CTS (Ciencia, Tec, Sociedad)
30-may;S√°bado;8:00 a.m. a 10:00 a.m.;Qu√≠mica;Estructura de la Materia
1-jun;Lunes;5:00 p.m. a 7:00 p.m.;Qu√≠mica;Tabla Peri√≥dica
2-jun;Martes;5:00 p.m. a 7:00 p.m.;Qu√≠mica;Enlaces Qu√≠micos
3-jun;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Qu√≠mica;Nomenclatura Inorg√°nica
4-jun;Jueves;5:00 p.m. a 7:00 p.m.;Qu√≠mica;Reacciones Qu√≠micas
6-jun;S√°bado;8:00 a.m. a 10:00 a.m.;Qu√≠mica;Estequiometr√≠a
8-jun;Lunes;5:00 p.m. a 7:00 p.m.;FESTIVO;Sagrado Coraz√≥n
9-jun;Martes;5:00 p.m. a 7:00 p.m.;Qu√≠mica;Gases ideales
10-jun;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Qu√≠mica;Soluciones y Mezclas
11-jun;Jueves;5:00 p.m. a 7:00 p.m.;Qu√≠mica;Qu√≠mica Org√°nica y Cierre
13-jun;S√°bado;8:00 a.m. a 10:00 a.m.;F√≠sica;Cinem√°tica (MRU, MRUA)
15-jun;Lunes;5:00 p.m. a 7:00 p.m.;FESTIVO;D√≠a no laboral
16-jun;Martes;5:00 p.m. a 7:00 p.m.;F√≠sica;Din√°mica (Leyes de Newton)
17-jun;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;F√≠sica;Energ√≠a Mec√°nica
18-jun;Jueves;5:00 p.m. a 7:00 p.m.;F√≠sica;Ondas y Sonido
20-jun;S√°bado;8:00 a.m. a 10:00 a.m.;F√≠sica;Termodin√°mica
22-jun;Lunes;5:00 p.m. a 7:00 p.m.;F√≠sica;Electromagnetismo I
23-jun;Martes;5:00 p.m. a 7:00 p.m.;F√≠sica;Electromagnetismo II
24-jun;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;F√≠sica;Circuitos El√©ctricos
25-jun;Jueves;5:00 p.m. a 7:00 p.m.;F√≠sica;Cierre de M√≥dulo
27-jun;S√°bado;8:00 a.m. a 10:00 a.m.;Ingl√©s;Vocabulario y Sin√≥nimos
29-jun;Lunes;5:00 p.m. a 7:00 p.m.;FESTIVO;San Pedro y San Pablo
30-jun;Martes;5:00 p.m. a 7:00 p.m.;Ingl√©s;Gram√°tica B√°sica
1-jul;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Ingl√©s;Intenci√≥n Comunicativa
2-jul;Jueves;5:00 p.m. a 7:00 p.m.;Ingl√©s;Prop√≥sito del Texto
4-jul;S√°bado;8:00 a.m. a 10:00 a.m.;Ingl√©s;Contextos de Conversaci√≥n
6-jul;Lunes;5:00 p.m. a 7:00 p.m.;Ingl√©s;Completar Conversaciones
7-jul;Martes;5:00 p.m. a 7:00 p.m.;üó£Ô∏è CHARLA 5;Estrategia Final: Gesti√≥n del Tiempo
8-jul;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Ingl√©s;Interpretaci√≥n de Avisos
9-jul;Jueves;5:00 p.m. a 7:00 p.m.;Ingl√©s;Lectura de Art√≠culos
11-jul;S√°bado;8:00 a.m. a 10:00 a.m.;SIMULACRO;üìå TERCER SIMULACRO (FINAL)
13-jul;Lunes;5:00 p.m. a 7:00 p.m.;Ingl√©s;Idea General del Texto
14-jul;Martes;5:00 p.m. a 7:00 p.m.;üó£Ô∏è CHARLA 6;D√≠a Cero: Preparaci√≥n Mental Final
15-jul;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Ingl√©s;Informaci√≥n Espec√≠fica
16-jul;Jueves;5:00 p.m. a 7:00 p.m.;Ingl√©s;Pr√°ctica Parte 4 y 5
18-jul;S√°bado;8:00 a.m. a 10:00 a.m.;Ingl√©s;Pr√°ctica Parte 6 y 7
20-jul;Lunes;5:00 p.m. a 7:00 p.m.;FESTIVO;D√≠a de la Independencia
21-jul;Martes;5:00 p.m. a 7:00 p.m.;Ingl√©s;Taller Final Tipo Examen
22-jul;Mi√©rcoles;5:00 p.m. a 7:00 p.m.;Ingl√©s;Cierre de M√≥dulo
23-jul;Jueves;5:00 p.m. a 7:00 p.m.;EVENTO;üéâ CLAUSURA DEL CURSO`;

        // 1. Funci√≥n Inteligente para procesar el CSV (Soporta comas de Google Sheets o punto y coma)
        function parseCSV(str) {
            const arr = [];
            let quote = false;
            let row = 0, col = 0;
            // Detecta autom√°ticamente si se usan comas o punto y coma
            const delimiter = (str.indexOf(';') !== -1 && str.indexOf(';') < str.indexOf('\n')) ? ';' : ',';

            for (let c = 0; c < str.length; c++) {
                let cc = str[c], nc = str[c+1];
                arr[row] = arr[row] || [];
                arr[row][col] = arr[row][col] || '';
                if (cc == '"' && quote && nc == '"') { arr[row][col] += cc; ++c; continue; }
                if (cc == '"') { quote = !quote; continue; }
                if (cc == delimiter && !quote) { ++col; continue; } 
                if (cc == '\r' && nc == '\n' && !quote) { ++row; col = 0; ++c; continue; }
                if (cc == '\n' && !quote) { ++row; col = 0; continue; }
                if (cc == '\r' && !quote) { ++row; col = 0; continue; }
                arr[row][col] += cc;
            }
            return arr;
        }

        // 2. Utilidades de Fecha
        const monthsNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
        
        function standardizeDate(dateStr) {
            const parts = dateStr.toLowerCase().split('-');
            if(parts.length === 2) {
                const day = parts[0].padStart(2, '0');
                const monthMap = { 'ene': '01', 'feb': '02', 'mar': '03', 'abr': '04', 'may': '05', 'jun': '06', 'jul': '07', 'ago': '08', 'sep': '09', 'oct': '10', 'nov': '11', 'dic': '12' };
                const month = monthMap[parts[1]] || '01';
                return `2026-${month}-${day}`; 
            }
            return dateStr;
        }

        function getMonthName(standardDate) {
            const parts = standardDate.split('-');
            if(parts.length < 2) return '';
            return monthsNames[parseInt(parts[1], 10) - 1];
        }

        function formatDateNice(standardDate) {
            const parts = standardDate.split('-');
            if(parts.length !== 3) return standardDate;
            return `${parseInt(parts[2], 10)} de ${getMonthName(standardDate)}`;
        }

        // 3. Estilos e Iconos din√°micos por √Årea
        function getStyleForArea(area) {
            if (!area) return { color: 'bg-slate-50 text-slate-700 border-slate-200', icon: 'fas fa-book text-slate-400' };
            
            const areaLower = area.toLowerCase();
            if (areaLower.includes('biolog√≠a')) return { color: 'bg-emerald-50 text-emerald-700 border-emerald-200', icon: 'fas fa-leaf text-emerald-500' };
            if (areaLower.includes('sociales')) return { color: 'bg-amber-50 text-amber-700 border-amber-200', icon: 'fas fa-globe-americas text-amber-500' };
            if (areaLower.includes('f√≠sica')) return { color: 'bg-purple-50 text-purple-700 border-purple-200', icon: 'fas fa-atom text-purple-500' };
            if (areaLower.includes('ingl√©s')) return { color: 'bg-blue-50 text-blue-700 border-blue-200', icon: 'fas fa-language text-blue-500' };
            if (areaLower.includes('matem√°tica')) return { color: 'bg-red-50 text-red-700 border-red-200', icon: 'fas fa-calculator text-red-500' };
            if (areaLower.includes('qu√≠mica')) return { color: 'bg-teal-50 text-teal-700 border-teal-200', icon: 'fas fa-flask text-teal-500' };
            if (areaLower.includes('lectura')) return { color: 'bg-indigo-50 text-indigo-700 border-indigo-200', icon: 'fas fa-book-open text-indigo-500' };
            if (areaLower.includes('festivo')) return { color: 'bg-slate-100 text-slate-600 border-slate-300', icon: 'fas fa-calendar-times text-slate-400' };
            if (areaLower.includes('charla')) return { color: 'bg-pink-50 text-pink-700 border-pink-200', icon: 'fas fa-comments text-pink-500' };
            if (areaLower.includes('simulacro')) return { color: 'bg-orange-50 text-orange-700 border-orange-200', icon: 'fas fa-file-signature text-orange-500' };
            if (areaLower.includes('evento')) return { color: 'bg-yellow-50 text-yellow-700 border-yellow-200', icon: 'fas fa-glass-cheers text-yellow-500' };
            if (areaLower.includes('cancelado')) return { color: 'bg-red-50 text-red-700 border-red-200', icon: 'fas fa-ban text-red-500' };

            return { color: 'bg-slate-50 text-slate-700 border-slate-200', icon: 'fas fa-book text-slate-400' };
        }

        // 4. Variables Globales y Carga de Datos
        let scheduleData = [];
        const grid = document.getElementById('schedule-grid');
        const noResults = document.getElementById('no-results');
        const monthFilter = document.getElementById('monthFilter');
        const areaFilter = document.getElementById('areaFilter');
        const resultsCount = document.getElementById('resultsCount');

        async function loadDataAndInit() {
            try {
                grid.innerHTML = '<div class="col-span-full text-center py-10 text-slate-500"><i class="fas fa-spinner fa-spin text-3xl mb-4"></i><br>Cargando cronograma...</div>';
                
                let textToProcess = fallbackData;

                // Si proporcionaste un enlace de Google Sheets, la p√°gina intentar√° descargarlo
                if (GOOGLE_SHEETS_CSV_URL && GOOGLE_SHEETS_CSV_URL.trim() !== "") {
                    try {
                        const response = await fetch(GOOGLE_SHEETS_CSV_URL);
                        if(response.ok) {
                            textToProcess = await response.text();
                        } else {
                            console.warn("No se pudo cargar Google Sheets, usando datos de respaldo.");
                        }
                    } catch (fetchError) {
                        console.warn("Error de conexi√≥n a Google Sheets, usando datos de respaldo.", fetchError);
                    }
                }

                // Procesar los datos (ya sean de Google Sheets o el respaldo)
                const raw = parseCSV(textToProcess.trim());
                
                scheduleData = raw.slice(1) // Ignorar encabezado
                    .filter(row => row.length >= 5 && row[0] && row[0].trim() !== '') // Evitar filas vac√≠as
                    .map(row => {
                        const originalDate = row[0].trim();
                        const standardDate = standardizeDate(originalDate);
                        return {
                            fecha_original: originalDate,
                            fecha_estandar: standardDate,
                            mes: getMonthName(standardDate),
                            dia: row[1] ? row[1].trim() : '',
                            horario: row[2] ? row[2].trim() : '',
                            area: row[3] ? row[3].trim() : '',
                            tema: row[4] ? row[4].trim() : ''
                        };
                    });

                // Ordenar cronol√≥gicamente usando la fecha est√°ndar (YYYY-MM-DD)
                scheduleData.sort((a, b) => a.fecha_estandar.localeCompare(b.fecha_estandar));

                // Identificar la clase de "Hoy" y la "Pr√≥xima"
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const todayStr = `${year}-${month}-${day}`;
                
                let foundNext = false;
                scheduleData.forEach(item => {
                    if (item.fecha_estandar === todayStr) {
                        item.esHoy = true;
                    } else if (item.fecha_estandar > todayStr && !foundNext) {
                        item.esProxima = true;
                        foundNext = true;
                    }
                });

                initFilters();
            } catch (e) {
                console.error("Error general", e);
                grid.innerHTML = `<div class="col-span-full text-center py-10 text-red-500 bg-red-50 rounded-xl border border-red-200"><i class="fas fa-exclamation-triangle text-3xl mb-4"></i><br><span class="font-semibold">Error al cargar la informaci√≥n.</span></div>`;
            }
        }

        // 5. Inicializar Filtros
        function initFilters() {
            const uniqueMonths = [...new Set(scheduleData.map(item => item.mes))].filter(Boolean);
            const uniqueAreas = [...new Set(scheduleData.map(item => item.area))].filter(Boolean);

            monthFilter.innerHTML = '<option value="all">üóìÔ∏è Todos los meses</option>';
            areaFilter.innerHTML = '<option value="all">üìö Todas las √°reas</option>';

            uniqueMonths.forEach(mes => {
                const option = document.createElement('option');
                option.value = mes;
                option.textContent = mes;
                monthFilter.appendChild(option);
            });

            uniqueAreas.forEach(area => {
                const option = document.createElement('option');
                option.value = area;
                option.textContent = area;
                areaFilter.appendChild(option);
            });

            monthFilter.addEventListener('change', renderFiltered);
            areaFilter.addEventListener('change', renderFiltered);

            renderFiltered();
        }

        function renderFiltered() {
            const selectedMonth = monthFilter.value;
            const selectedArea = areaFilter.value;

            const filtered = scheduleData.filter(item => {
                const matchMonth = selectedMonth === 'all' || item.mes === selectedMonth;
                const matchArea = selectedArea === 'all' || item.area === selectedArea;
                return matchMonth && matchArea;
            });

            grid.innerHTML = '';
            
            if (filtered.length === 0) {
                grid.classList.add('hidden');
                noResults.classList.remove('hidden');
            } else {
                grid.classList.remove('hidden');
                noResults.classList.add('hidden');
                
                filtered.forEach(item => {
                    const style = getStyleForArea(item.area);
                    const isFestivo = item.area.toLowerCase().includes('festivo');
                    const isCancelado = item.area.toLowerCase().includes('cancelado');
                    
                    let badgeHtml = '';
                    let borderShadowClass = 'border-slate-200 hover:shadow-lg';
                    
                    // Asignar resaltado seg√∫n fecha
                    if (item.esHoy) {
                        badgeHtml = `<div class="absolute top-0 right-0 bg-rose-500 text-white text-xs font-bold px-3 py-1 rounded-bl-lg rounded-tr-xl shadow-sm z-10 flex items-center gap-1 animate-pulse"><i class="fas fa-star"></i> ¬°HOY!</div>`;
                        borderShadowClass = 'border-rose-400 ring-2 ring-rose-400 shadow-md shadow-rose-100';
                    } else if (item.esProxima) {
                        badgeHtml = `<div class="absolute top-0 right-0 bg-indigo-500 text-white text-xs font-bold px-3 py-1 rounded-bl-lg rounded-tr-xl shadow-sm z-10 flex items-center gap-1"><i class="fas fa-arrow-right"></i> PR√ìXIMA</div>`;
                        borderShadowClass = 'border-indigo-400 ring-2 ring-indigo-400 shadow-md shadow-indigo-100';
                    }
                    
                    const card = document.createElement('div');
                    card.className = `bg-white rounded-xl shadow-sm border ${borderShadowClass} relative overflow-hidden transition-all duration-300 transform hover:-translate-y-1 flex flex-col h-full`;
                    
                    card.innerHTML = `
                        ${badgeHtml}
                        <div class="px-5 py-3 ${style.color} border-b flex items-center justify-between">
                            <span class="font-bold text-xs uppercase tracking-wider">${item.area}</span>
                            <i class="${style.icon} text-xl"></i>
                        </div>
                        <div class="p-6 flex-grow flex flex-col justify-center">
                            <div class="flex items-center text-slate-500 text-sm mb-2 font-medium">
                                <i class="far fa-calendar-alt w-5"></i> 
                                ${item.dia}, ${formatDateNice(item.fecha_estandar)}
                            </div>
                            <div class="flex items-center text-slate-500 text-sm mb-4 font-medium">
                                <i class="far fa-clock w-5"></i> 
                                ${item.horario}
                            </div>
                            <h3 class="text-lg font-bold ${isFestivo || isCancelado ? 'text-slate-500 line-through' : 'text-slate-800'} leading-tight mt-auto">
                                ${item.tema}
                            </h3>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            }

            // Actualizar contador
            resultsCount.innerHTML = `<i class="fas fa-check-circle mr-1"></i> ${filtered.length} clase${filtered.length !== 1 ? 's' : ''}`;
        }

        function resetFilters() {
            monthFilter.value = 'all';
            areaFilter.value = 'all';
            renderFiltered();
        }

        // Iniciar la aplicaci√≥n cuando cargue la p√°gina
        document.addEventListener('DOMContentLoaded', loadDataAndInit);
    </script>
</body>
</html>
